created: 20231106020821431
creator: ç¿Ÿä¸æ­¢
modified: 20231106044905909
modifier: ç¿Ÿä¸æ­¢
tags: æŠ€æœ¯åˆ†äº«
title: æ–è®¯n1åˆ·armbianåˆ©ç”¨sing-boxåšé€æ˜ä»£ç†

é¦–å…ˆåˆ·n1 å…·ä½“åˆ·æœºæ­¥éª¤æˆ‘å°±ä¸æ¼”ç¤ºäº†ï¼Œè¿™ä¸ªæ˜¯n1çš„armbian

ä¸‹è½½åœ°å€

https://github.com/ophub/amlogic-s9xxx-armbian

å‡†å¤‡å·¥å…·

sshé“¾æ¥å·¥å…·  æˆ‘ç”¨çš„termius   ï¼ˆä¸»è¦æ˜¯å¯ä»¥ç›´æ¥ç»™æ–‡ä»¶æƒé™ä¸éœ€è¦è¾“å…¥ä»£ç ï¼‰

ä¸‹è½½sing-box

https://github.com/SagerNet/sing-box/releases

ä¸‹è½½arm64 linuxçš„ç‰ˆæœ¬çš„è§£å‹åˆ©ç”¨sftpä¸Šä¼   åˆ°/usr/local/bin å¹¶ä¸”é‡å‘½åä¸ºsing-box
ç¼–è¾‘è‡ªå¯åŠ¨é€‰é¡¹
vim


```
[Unit]
Description=sing-box service
Documentation=https://sing-box.sagernet.org
After=network.target nss-lookup.target

[Service]
User=root
WorkingDirectory=/usr/local/share/sing-box
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW CAP_SYS_PTRACE CAP_DAC_READ_SEARCH
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW CAP_SYS_PTRACE CAP_DAC_READ_SEARCH
ExecStart=/usr/local/bin/sing-box run -c /usr/local/etc/sing-box/config.json
ExecReload=/bin/kill -HUP $MAINPID
Restart=on-failure
RestartSec=10
LimitNOFILE=infinity

[Install]
WantedBy=multi-user.target

```


ExecStart å°±æ˜¯sing-boxå¯åŠ¨å‘½ä»¤ æ³¨æ„æ–‡ä»¶ä½ç½®

æ¥ç€ç¼–è¾‘é…ç½®æ–‡ä»¶


```
vim /usr/local/etc/sing-box/config.json
```


```
{
    "log":{
        "level":"debug",
        "timestamp":true
    },
    "dns":{
        "servers":[
            {
                "tag":"google",
                "address":"tls://8.8.8.8"
            },
            {
                "tag":"local",
                "address":"223.5.5.5",
                "detour":"direct"
            },
            {
                "tag":"remote",
                "address":"fakeip"
            },
            {
                "tag":"block",
                "address":"rcode://success"
            }
        ],
        "rules":[
            {
                "geosite":"category-ads-all",
                "server":"block",
                "disable_cache":true
            },
            {
                "outbound":"any",
                "server":"local"
            },
            {
                "geosite":"cn",
                "server":"local"
            },
            {
                "query_type":[
                    "A",
                    "AAAA"
                ],
                "server":"remote"
            }
        ],
        "fakeip":{
            "enabled":true,
            "inet4_range":"198.18.0.0/15",
            "inet6_range":"fc00::/18"
        },
        "independent_cache":true,
        "strategy":"ipv4_only"
    },
    "inbounds":[
        {
            "type":"tun",
            "inet4_address":"172.19.0.1/30",
            "mtu":9000,
            "auto_route":true,
            "strict_route":true,
            "sniff":true,
            "endpoint_independent_nat":false,
            "stack":"system",
            "platform":{
                "http_proxy":{
                    "enabled":true,
                    "server":"127.0.0.1",
                    "server_port":2080
                }
            }
        },
        {
            "type":"mixed",
            "listen":"127.0.0.1",
            "listen_port":2080,
            "sniff":true,
            "users":[

            ]
        }
    ],
    "outbounds":[
//ä½ çš„èŠ‚ç‚¹
        {
            "tag":"proxy",
            "type":"selector",
            "outbounds":[
                "HKB-NAT",
                "NNC-HK",
                "AKILE-TW",
                "REALITY-LA-9929",
                "REALITY-JP-BWG"
            ],
            "default":"REALITY-LA-9929",
            "interrupt_exist_connections":false
        },
        {
            "tag":"ğŸ¤– OpenAI",
            "type":"selector",
            "outbounds":[
                "direct",
                "REALITY-LA-9929"
            ]
        },
        {
            "tag":"ğŸ¬ Disney",
            "type":"urltest",
            "outbounds":[
                "HKB-NAT",
                "NNC-HK"
            ],
            "url":"https://www.gstatic.com/generate_204",
            "interval":"1m",
            "tolerance":2000
        },
        {
            "tag":"ğŸ¬ MediaVideo",
            "type":"urltest",
            "outbounds":[
                "AKILE-TW",
                "HKB-NAT"
            ],
            "url":"https://www.gstatic.com/generate_204",
            "interval":"1m",
            "tolerance":2000
        },
        {
            "type":"direct",
            "tag":"direct"
        },
        {
            "type":"dns",
            "tag":"dns-out"
        },
        {
            "type":"block",
            "tag":"block"
        }
    ],
    "route":{
        "auto_detect_interface":true,
        "final":"proxy",
        "geoip":{
            "download_url":"https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.db",
            "download_detour":"proxy"
        },
        "geosite":{
            "download_url":"https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.db",
            "download_detour":"proxy"
        },
        "rules":[
            {
                "protocol":"dns",
                "outbound":"dns-out"
            },
            {
                "network":"udp",
                "port":443,
                "outbound":"block"
            },
            {
                "geosite":"category-ads-all",
                "outbound":"block"
            },
            {
                "clash_mode":"direct",
                "outbound":"direct"
            },
            {
                "clash_mode":"global",
                "outbound":"proxy"
            },
            {
                "domain":[
                    "clash.razord.top",
                    "yacd.metacubex.one",
                    "yacd.haishan.me",
                    "d.metacubex.one",
                    "new.cargoware.com"
                ],
                "outbound":"direct"
            },
            {
                "geosite":"openai",
                "domain_keyword":"claude",
                "outbound":"ğŸ¤– OpenAI"
            },
            {
                "geosite":"apple",
                "outbound":"direct"
            },
            {
                "geosite":"apple-cn",
                "outbound":"direct"
            },
            {
                "geosite":"bilibili",
                "outbound":"direct"
            },
            {
                "geosite":"disney",
                "outbound":"ğŸ¬ Disney"
            },
            {
                "geoip":"netflix",
                "outbound":"ğŸ¬ MediaVideo"
            },
            {
                "geosite":[
                    "tiktok",
                    "netflix",
                    "hbo",
                    "primevideo"
                ],
                "outbound":"ğŸ¬ MediaVideo"
            },
            {
                "geosite":[
                    "apple@cn",
                    "category-games@cn",
                    "cn",
                    "private"
                ],
                "geoip":[
                    "cn",
                    "private"
                ],
                "outbound":"direct"
            }
        ]
    },
    "experimental":{
        "clash_api":{
            "external_controller":"0.0.0.0:9090",
            "external_ui_download_url":"",
            "external_ui_download_detour":"",
            "external_ui":"ui",
            "secret":"",
            "default_mode":"rule",
            "store_selected":true,
            "cache_file":"",
            "cache_id":""
        }
    }
}
```

æŒ‰escï¼Œ:wq ä¿å­˜é€€å‡º

æ¥ç€å¯åŠ¨sing-box


```
systemctl enable sing-box&&systemctl stop sing-box&&systemctl restart sing-box&&systemctl status sing-box
```

ä¹‹åæŠŠéœ€è¦ç§‘å­¦ä¸Šç½‘çš„è®¾å¤‡è·¯ç”±å™¨ç½‘å…³æ”¹æˆä½ çš„n1 IPåœ°å€å°±è¡Œ